<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Calculadora Simb√≥lica Ecuaciones Lineales</title>

<style>
/* ======= PALETA BASE ======= */
:root {
    /* Modo claro (m√°s colorido) */
    --bg-color: #eaf4ff;
    --container-bg: #ffffff;
    --text-color: #1a2b44;
    --accent-color: #007bff;
    --accent-hover: #0056b3;
    --border-color: #c8d6e5;
    --input-bg: #f0f7ff;
    --result-bg: #f5f9ff;
    --error-color: #e74c3c;
    --table-header-bg: #0056b3;
    --shadow-color: rgba(0, 123, 255, 0.2);
}

/* ======= MODO OSCURO ======= */
body.dark {
    --bg-color: #0a0f1a;
    --container-bg: #111827;
    --text-color: #e0e6ed;
    --accent-color: #3b82f6;
    --accent-hover: #2563eb;
    --border-color: #1f2937;
    --input-bg: #1b2333;
    --result-bg: #1e293b;
    --error-color: #f87171;
    --table-header-bg: #1e40af;
    --shadow-color: rgba(0, 0, 0, 0.5);
}

/* ======= RESETEO ======= */
* {
    box-sizing: border-box;
    transition: background 0.4s ease, color 0.4s ease, border 0.4s ease;
}

/* ======= ESTRUCTURA GENERAL ======= */
body {
    font-family: 'Poppins', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background: var(--bg-color);
    color: var(--text-color);
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
}

/* ======= HEADER ======= */
header {
    
    top: 0;
    left: 0;
    width: 100%;
    background: linear-gradient(90deg, #007bff, #00c6ff);
    color: white;
    text-align: center;
    padding: 30px 50px;
    
    box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
}

header h1 {
    margin: 0;
    font-size: 1.8em;
    letter-spacing: 1px;
}

header .subtitle {
    font-size: 0.95em;
    opacity: 0.9;
}

/* ======= CONTENIDO ======= */
main {
    flex: 1;
    margin-top: 120px; /* espacio para el header */
    margin-bottom: 100px; /* espacio para el footer */
    display: flex;
    justify-content: center;
    padding: 20px;
}

.container {
    background: var(--container-bg);
    padding: 40px;
    border-radius: 16px;
    box-shadow: 0 10px 25px var(--shadow-color);
    width: 100%;
    max-width: 900px;
    transition: background 0.4s ease, box-shadow 0.4s ease, transform 0.3s ease;
}
.container:hover {
    transform: translateY(-3px);
}

/* ======= T√çTULOS ======= */
.container h1 {
    text-align: center;
    font-size: 2.2em;
    background: linear-gradient(90deg, var(--accent-color), #60a5fa);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 25px;
}

h2 {
    color: var(--accent-color);
    border-left: 5px solid var(--accent-color);
    padding-left: 10px;
    margin-top: 30px;
    margin-bottom: 15px;
    font-size: 1.4em;
}

/* ======= BOT√ìN DE MODO OSCURO ======= */
.theme-toggle {
    float: right;
    background: transparent;
    color: var(--accent-color);
    border: 2px solid var(--accent-color);
    font-size: 0.9em;
    padding: 8px 15px;
    border-radius: 8px;
    font-weight: 600;
    transition: all 0.3s ease;
}
.theme-toggle:hover {
    background: var(--accent-color);
    color: white;
}

/* ======= INPUTS ======= */
input[type="text"], input[type="number"] {
    width: 100%;
    padding: 12px 15px;
    border: 1.5px solid var(--border-color);
    border-radius: 10px;
    font-size: 1.05em;
    margin-bottom: 15px;
    background-color: var(--input-bg);
    color: var(--text-color);
    font-family: 'Courier New', monospace;
    transition: all 0.3s ease;
}
input[type="text"]:focus, input[type="number"]:focus {
    border-color: var(--accent-color);
    box-shadow: 0 0 10px rgba(59, 130, 246, 0.3);
    outline: none;
}

/* ======= BOTONES ======= */
button {
    background: var(--accent-color);
    color: white;
    padding: 12px 25px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    font-size: 1.05em;
    font-weight: 600;
    transition: all 0.3s ease;
    margin-right: 10px;
    margin-bottom: 10px;
}
button:hover {
    background: var(--accent-hover);
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(59, 130, 246, 0.3);
}

/* ======= SEPARADOR ======= */
hr {
    border: none;
    height: 2px;
    background: linear-gradient(to right, transparent, var(--accent-color), transparent);
    margin: 40px 0;
    border-radius: 5px;
}

/* ======= RESULTADOS ======= */
.result-box {
    background-color: var(--result-bg);
    border: 1px solid var(--border-color);
    padding: 20px;
    border-radius: 10px;
    font-size: 1.05em;
    margin-top: 15px;
}
.result-box:empty {
    display: none;
}

.error-message {
    color: var(--error-color);
    font-weight: bold;
    margin-top: 10px;
    min-height: 20px;
}

/* ======= TABLAS ======= */
.result-box table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 15px;
    background-color: var(--container-bg);
    border-radius: 8px;
    overflow: hidden;
}
.result-box thead {
    background-color: var(--table-header-bg);
    color: white;
}
.result-box th, .result-box td {
    padding: 12px;
    text-align: left;
    border-bottom: 1px solid var(--border-color);
}
.result-box tbody tr:nth-child(even) {
    background-color: var(--input-bg);
}
.result-box tbody tr:hover {
    background-color: var(--accent-color);
    color: white;
}

/* ======= FOOTER ======= */
footer {
    
    bottom: 0;
    left: 0;
    width: 100%;
    background: linear-gradient(90deg, #001f3f, #004080);
    color: white;
    text-align: center;
    padding: 15px 10px;
    box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.3);
    font-size: 0.9em;
}

footer p {
    margin: 3px 0;
}

/* ======= RESPONSIVE ======= */
@media (max-width: 768px) {
    .container {
        padding: 25px;
    }
    header h1 {
        font-size: 1.5em;
    }
}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.min.js"></script>
</head>

<body>
<header>
    <h1>Divisi√≥n Sint√©tica de Polinomios</h1>
    <p class="subtitle">Soporta coeficientes y ra√≠ces reales y complejas</p>
</header>

<main>
    <div class="container">
        <button class="theme-toggle" onclick="toggleTheme()">üåô Modo Oscuro</button>
        <h1>Calculadora Simb√≥lica de Ecuaciones</h1>

        <section class="solver-section">
            <h2>1. Soluci√≥n de Ecuaciones de una Variable (x)</h2>
            <p>Introduce la ecuaci√≥n lineal para despejar <strong>x</strong> (ej: 2x + 3 = x + 8):</p>
            <input type="text" id="ecuacion" value="2x + 3 = x + 8">
            <button onclick="resolverEcuacionParseada()">Resolver</button>
            <div id="resDespejeParseado" class="result-box"></div>
            <div id="mensajeError" class="error-message"></div>
        </section>

        <hr>

        <section class="solver-section">
            <h2>2. Despeje Simb√≥lico de F√≥rmulas</h2>
            <p>Introduce cualquier f√≥rmula matem√°tica (ej: C = 5(F - 32)/9):</p>
            
            <div class="formula-input-container">
                <label for="formulaLiteral">F√≥rmula:</label>
                <input type="text" id="formulaLiteral" value="C = 5(F - 32)/9" placeholder="Ej: T = F*c/r">
            </div>
            
            <button onclick="procesarFormulaLiteral()">Generar Despejes Simb√≥licos</button>

            <div id="resFormulaLiteral" class="result-box"></div>
            <div id="mensajeErrorFormula" class="error-message"></div>
        </section>
    </div>
</main>

<footer>
    <p>Fundamentos de √Ålgebra ‚Äî TSU en Desarrollo de Software</p>
    <p>1¬∞ Cuatrimestre 2025 ¬∑ Grupo 1C</p>
    <p>Profesor: M. en C. Jorge J. Pedrozo Romero</p>
    <p>Alumno: Euruviel M√°rquez Mart√≠nez</p>
</footer>

<script>
function toggleTheme() {
    document.body.classList.toggle('dark');
    const btn = document.querySelector('.theme-toggle');
    btn.textContent = document.body.classList.contains('dark') ? '‚òÄÔ∏è Modo Claro' : 'üåô Modo Oscuro';
}
    // Utilidad para limpiar strings
function cleanString(str) {
    return str.replace(/\s+/g, '');
}

// --- PARTE 1: Soluci√≥n de Ecuaciones de una Variable (x) ---

/**
 * Resuelve ecuaciones lineales de una variable usando √°lgebra simb√≥lica
 */
function resolverEcuacionParseada() {
    const ecuacionStr = document.getElementById('ecuacion').value;
    const resBox = document.getElementById('resDespejeParseado');
    const errorBox = document.getElementById('mensajeError');

    resBox.innerHTML = '';
    errorBox.innerText = '';

    try {
        // Dividir por el signo igual
        const partes = ecuacionStr.split('=');
        if (partes.length !== 2) {
            throw new Error("La ecuaci√≥n debe contener exactamente un signo '='");
        }

        const ladoIzq = partes[0].trim();
        const ladoDer = partes[1].trim();

        // Crear la ecuaci√≥n en formato: lado_izquierdo - lado_derecho
        const ecuacionFormateada = `(${ladoIzq}) - (${ladoDer})`;

        // Parsear y simplificar
        const nodo = math.parse(ecuacionFormateada);
        const simplificado = math.simplify(nodo);

        // Resolver manualmente para x
        // Formato t√≠pico despu√©s de simplificar: ax + b = 0
        const coeficientes = extraerCoeficientes(simplificado.toString());
        const solucion = -coeficientes.b / coeficientes.a;

        // Mostrar resultado
        resBox.innerHTML = `
            <div class="formula-original">
                <strong>Ecuaci√≥n Original:</strong> ${ecuacionStr}
            </div>
            <p><strong>Soluci√≥n:</strong> x = ${solucion}</p>
            <p><strong>Ecuaci√≥n Simplificada:</strong> ${simplificado.toString()} = 0</p>
        `;
    } catch (error) {
        errorBox.innerText = `Error: ${error.message}`;
    }
}

/**
 * Extrae coeficientes de una ecuaci√≥n lineal simplificada
 */
function extraerCoeficientes(ecuacion) {
    // Eliminar espacios
    ecuacion = ecuacion.replace(/\s+/g, '');

    let a = 0; // Coeficiente de x
    let b = 0; // T√©rmino independiente

    // Buscar t√©rminos con x
    const regexX = /([+-]?\d*\.?\d*)\*?x/g;
    let match;
    while ((match = regexX.exec(ecuacion)) !== null) {
        let coef = match[1];
        if (coef === '' || coef === '+') coef = '1';
        if (coef === '-') coef = '-1';
        a += parseFloat(coef);
    }

    // Buscar t√©rminos constantes (sin x)
    const sinX = ecuacion.replace(/[+-]?\d*\.?\d*\*?x/g, '');
    if (sinX) {
        try {
            b = math.evaluate(sinX);
        } catch (e) {
            b = 0;
        }
    }

    return { a, b };
}

// --- PARTE 2: Despeje Simb√≥lico de F√≥rmulas ---

/**
 * Extrae todas las variables √∫nicas de una f√≥rmula
 */
function extractVariables(formulaStr) {
    const matches = formulaStr.match(/[a-zA-Z][a-zA-Z0-9]*/g);
    if (!matches) return [];
    return Array.from(new Set(matches));
}

/**
 * Despeja una variable de una f√≥rmula
 */
function despejarVariable(expresionOriginal, variableObjetivo, variableDespejada) {
    try {
        // Limpiar espacios
        let expresion = expresionOriginal.replace(/\s+/g, '');

        // CASO ESPECIAL: Expresiones con par√©ntesis tipo coef(var ¬± const)/div
        // Ejemplo: 5(F-32)/9, despejar F
        const patronComplejo = /(\d*\.?\d*)\(([a-zA-Z]+)\s*([+-])\s*(\d+\.?\d*)\)\s*\/\s*(\d+\.?\d*)/;
        const matchComplejo = expresion.match(patronComplejo);

        if (matchComplejo && matchComplejo[2] === variableObjetivo) {
            const coef1 = matchComplejo[1] || '1';
            const operador = matchComplejo[3];
            const constante = matchComplejo[4];
            const divisor = matchComplejo[5];

            const operadorInverso = operador === '-' ? '+' : '-';

            if (coef1 === '1') {
                return `(${variableDespejada}) * (${divisor}) ${operadorInverso} ${constante}`;
            } else {
                return `(${variableDespejada}) * (${divisor}) / (${coef1}) ${operadorInverso} ${constante}`;
            }
        }

        // CASO: Suma o resta simple
        // Ejemplo: 14 - pOH, despejar pOH -> pOH = 14 - pH
        if (expresion.includes('+') || expresion.includes('-')) {
            const resultado = despejarSumaResta(expresion, variableObjetivo, variableDespejada);
            if (resultado !== null) {
                return resultado;
            }
        }

        // CASO: Divisi√≥n simple
        if (expresion.includes('/')) {
            const partes = dividirPorOperadorPrincipal(expresion, '/');
            const numerador = partes[0];
            const denominador = partes[1];

            // Verificar si la variable est√° en el numerador o denominador
            if (numerador.includes(variableObjetivo)) {
                // Variable en numerador
                if (numerador === variableObjetivo) {
                    // varObjetivo / denominador
                    return `(${variableDespejada}) * (${denominador})`;
                } else {
                    // Multiplicaci√≥n en numerador: a*b*varObjetivo / denominador
                    const factoresNum = extraerFactoresMultiplicacion(numerador);
                    const otrosFactores = factoresNum.filter(f => f !== variableObjetivo);

                    if (otrosFactores.length === 0) {
                        return `(${variableDespejada}) * (${denominador})`;
                    } else {
                        return `(${variableDespejada}) * (${denominador}) / (${otrosFactores.join(' * ')})`;
                    }
                }
            } else if (denominador.includes(variableObjetivo)) {
                // Variable en denominador
                if (denominador === variableObjetivo) {
                    // numerador / varObjetivo
                    return `(${numerador}) / (${variableDespejada})`;
                } else {
                    // Multiplicaci√≥n en denominador
                    const factoresDen = extraerFactoresMultiplicacion(denominador);
                    const otrosFactores = factoresDen.filter(f => f !== variableObjetivo);

                    if (otrosFactores.length === 0) {
                        return `(${numerador}) / (${variableDespejada})`;
                    } else {
                        return `(${numerador}) / ((${variableDespejada}) * (${otrosFactores.join(' * ')}))`;
                    }
                }
            }
        }

        // CASO: Multiplicaci√≥n simple (sin divisi√≥n)
        if (expresion.includes('*')) {
            const factores = extraerFactoresMultiplicacion(expresion);
            const otrosFactores = factores.filter(f => f !== variableObjetivo);

            if (otrosFactores.length === 0) {
                return variableDespejada;
            } else if (otrosFactores.length === 1) {
                return `(${variableDespejada}) / (${otrosFactores[0]})`;
            } else {
                return `(${variableDespejada}) / (${otrosFactores.join(' * ')})`;
            }
        }

        // CASO: Variable sola
        if (expresion === variableObjetivo) {
            return variableDespejada;
        }

        return expresion;

    } catch (error) {
        return `Error: ${error.message}`;
    }
}

/**
 * Despeja una variable de una expresi√≥n con suma o resta
 */
function despejarSumaResta(expresion, variableObjetivo, variableDespejada) {
    // Parsear la expresi√≥n en t√©rminos
    const terminos = parsearTerminos(expresion);

    // Encontrar el t√©rmino que contiene la variable objetivo
    let terminoConVariable = null;
    let otrosTerminos = [];

    for (const termino of terminos) {
        if (termino.texto.includes(variableObjetivo)) {
            terminoConVariable = termino;
        } else {
            otrosTerminos.push(termino);
        }
    }

    if (!terminoConVariable) {
        return null;
    }

    // Construir el despeje
    // Si tenemos: A = B + C - D, y queremos despejar C
    // Entonces: C = A - B + D

    let resultado = variableDespejada;

    for (const termino of otrosTerminos) {
        // Invertir el signo
        const signoInverso = termino.signo === '+' ? '-' : '+';
        resultado += ` ${signoInverso} ${termino.texto}`;
    }

    // Si el t√©rmino con la variable tiene coeficiente o signo negativo
    if (terminoConVariable.texto !== variableObjetivo) {
        // Caso: tiene coeficiente (ej: 2*var)
        if (terminoConVariable.texto.includes('*')) {
            const partes = terminoConVariable.texto.split('*');
            const coef = partes.find(p => p !== variableObjetivo);
            resultado = `(${resultado}) / (${coef})`;
        }
    }

    // Si el signo era negativo, invertir todo
    if (terminoConVariable.signo === '-') {
        resultado = `-(${resultado})`;
    }

    return resultado;
}

/**
 * Parsea una expresi√≥n en t√©rminos con sus signos
 */
function parsearTerminos(expresion) {
    const terminos = [];
    let actual = '';
    let signo = '+';
    let nivel = 0;

    for (let i = 0; i < expresion.length; i++) {
        const char = expresion[i];

        if (char === '(') {
            nivel++;
            actual += char;
        } else if (char === ')') {
            nivel--;
            actual += char;
        } else if ((char === '+' || char === '-') && nivel === 0 && actual !== '') {
            terminos.push({ signo: signo, texto: actual });
            signo = char;
            actual = '';
        } else if ((char === '+' || char === '-') && nivel === 0 && actual === '') {
            signo = char;
        } else {
            actual += char;
        }
    }

    if (actual) {
        terminos.push({ signo: signo, texto: actual });
    }

    return terminos;
}

/**
 * Divide una expresi√≥n por el operador principal (respetando par√©ntesis)
 */
function dividirPorOperadorPrincipal(expresion, operador) {
    let nivel = 0;
    let ultimaPosicion = -1;

    // Buscar el operador al nivel 0 de par√©ntesis (de derecha a izquierda para divisi√≥n)
    for (let i = expresion.length - 1; i >= 0; i--) {
        const char = expresion[i];

        if (char === ')') {
            nivel++;
        } else if (char === '(') {
            nivel--;
        } else if (char === operador && nivel === 0) {
            ultimaPosicion = i;
            break;
        }
    }

    if (ultimaPosicion === -1) {
        return [expresion];
    }

    const parte1 = expresion.substring(0, ultimaPosicion);
    const parte2 = expresion.substring(ultimaPosicion + 1);

    return [parte1, parte2];
}

/**
 * Extrae factores de una multiplicaci√≥n (respetando par√©ntesis)
 */
function extraerFactoresMultiplicacion(expresion) {
    const factores = [];
    let actual = '';
    let nivel = 0;

    for (let i = 0; i < expresion.length; i++) {
        const char = expresion[i];

        if (char === '(') {
            nivel++;
            actual += char;
        } else if (char === ')') {
            nivel--;
            actual += char;
        } else if (char === '*' && nivel === 0) {
            if (actual) {
                factores.push(actual);
                actual = '';
            }
        } else {
            actual += char;
        }
    }

    if (actual) {
        factores.push(actual);
    }

    return factores;
}

/**
 * Procesa la f√≥rmula y genera todos los despejes posibles
 */
function procesarFormulaLiteral() {
    const formulaStr = document.getElementById('formulaLiteral').value;
    const resBox = document.getElementById('resFormulaLiteral');
    const errorBox = document.getElementById('mensajeErrorFormula');

    resBox.innerHTML = '';
    errorBox.innerText = '';

    try {
        // Dividir por el signo igual
        const partes = formulaStr.split('=');
        if (partes.length !== 2) {
            throw new Error("La f√≥rmula debe contener exactamente un signo '='");
        }

        const ladoIzq = partes[0].trim();
        const ladoDer = partes[1].trim();

        // Extraer todas las variables
        const variables = extractVariables(formulaStr);

        if (variables.length < 2) {
            throw new Error("Se necesitan al menos 2 variables distintas en la f√≥rmula");
        }

        // Construir tabla de despejes
        let htmlTable = `
            <div class="formula-original">
                <strong>F√≥rmula Original:</strong> ${formulaStr}
            </div>
            <p><strong>Variables detectadas:</strong> ${variables.join(', ')}</p>
            <table>
                <thead>
                    <tr>
                        <th>Variable Despejada</th>
                        <th>F√≥rmula Resultante</th>
                    </tr>
                </thead>
                <tbody>
        `;

        // Generar despeje para cada variable
        for (const variable of variables) {
            let formulaDespejada;

            // Si la variable est√° en el lado izquierdo, mostrar la f√≥rmula original
            if (ladoIzq === variable) {
                formulaDespejada = `${variable} = ${ladoDer}`;
            } else {
                // Necesitamos despejar esta variable del lado derecho
                const resultado = despejarVariable(ladoDer, variable, ladoIzq);
                formulaDespejada = `${variable} = ${resultado}`;
            }

            htmlTable += `
                <tr>
                    <td><strong>${variable}</strong></td>
                    <td><pre>${formulaDespejada}</pre></td>
                </tr>
            `;
        }

        htmlTable += `
                </tbody>
            </table>
            <div class="nota-didactica">
                <strong>Nota:</strong> Los despejes son generados usando manipulaci√≥n algebraica directa.
                Soporta suma, resta, multiplicaci√≥n, divisi√≥n y expresiones con par√©ntesis.
            </div>
        `;

        resBox.innerHTML = htmlTable;

    } catch (error) {
        errorBox.innerText = `Error: ${error.message}`;
    }
}

// --- Inicializaci√≥n ---
document.addEventListener('DOMContentLoaded', () => {
    // Inicializa con los ejemplos al cargar
    resolverEcuacionParseada();
});
</script>
</body>
</html>
